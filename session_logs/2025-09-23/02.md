# Development Session Log

Date: 2025-09-23

## Summary of Accomplishments

- IMPL-001: Weekly prediction generator fixed and replaced with a clean, data-root-driven script.
  - Added src/cfb_model/scripts/generate_weekly_bets_clean.py (reuses modeling helpers; no API dependency; bets to reports/YYYY/CFB_weekWW_bets.csv).
- IMPL-002: Built generalized weekly scoring tool and validated Week 5.
  - Added scripts/score_weekly_picks.py to merge picks with raw outcomes and compute per-game coverage + hit.
  - Week 5 spread results: 39/47 = 0.830 hit rate.
- IMPL-003: Ran season remainder (Weeks 6–16) end-to-end and combined results.
  - Generated and scored each week, produced combined CSV: reports/2024/CFB_weeks6-16_bets_scored_combined.csv.
  - Final spread hit rate across weeks 6–16: 387/440 = 0.880.
- IMPL-004: Documentation updates.
  - docs/operations/weekly_pipeline.md: Added “Prediction & Scoring (MVP commands)” with week-level and season remainder commands.

## Key Outcomes

- Corrupted generate_weekly_bets.py replaced by a clean script that aligns with training features and storage contracts.
- Reproducible weekly prediction + scoring workflow with explicit CLI and combined-season automation.
- Verified model performance on Week 5 and on the remainder of 2024 with auditable per-game outputs.

## Blockers Encountered

- The local data/processed and data/raw under repo were empty; actual data resides on an external drive.
  - Resolution: Located external data root via docs guidance ("/Volumes/CK SSD/Coding Projects/cfb_model").
- generate_weekly_bets.py was corrupted (duplicated blocks, stray text) and not runnable.
  - Resolution: Added generate_weekly_bets_clean.py, then deprecated the corrupted script for this run.
- sklearn version mismatch warning on model load (1.7.1 artifact vs 1.5.1 runtime).
  - Resolution: Proceeded with caution; models loaded successfully. Suggest aligning scikit-learn versions to silence warning.

## New Learnings / Patterns

- [KB:DirectScriptImports] and PYTHONPATH=./src are reliable for running tooling ad hoc.
- Using a home-oriented spread convention end-to-end simplifies scoring logic and audit outputs.
- Season remainder orchestration is concise with a small Python snippet that discovers weeks from raw games.

## Next Steps

- Extend scoring to include totals (over/under) outcomes in the same per-game scored CSV.
- Add a simple regression test for generate_weekly_bets_clean to ensure feature list construction is stable.
- Consider a version pin/harmonization for scikit-learn to avoid InconsistentVersionWarning on artifact load.
- Optional: add a single "run_weekly_pipeline.py" to wrap generate+score for a given week.

## Artifacts

- Weekly picks (examples): reports/2024/CFB_week5_bets.csv, reports/2024/CFB_week6_bets.csv, ... reports/2024/CFB_week16_bets.csv
- Scored picks: reports/2024/CFB_week5_bets_scored.csv, ... reports/2024/CFB_week16_bets_scored.csv
- Combined scored: reports/2024/CFB_weeks6-16_bets_scored_combined.csv
- Scripts: src/cfb_model/scripts/generate_weekly_bets_clean.py, scripts/score_weekly_picks.py

## Session Handoff

- To generate and score a specific week:
  - Generate: PYTHONPATH=./src python3 src/cfb_model/scripts/generate_weekly_bets_clean.py --year 2024 --week 5 --data-root "/Volumes/CK SSD/Coding Projects/cfb_model" --model-dir ./models/ridge_baseline --output-dir ./reports
  - Score: PYTHONPATH=./src python3 scripts/score_weekly_picks.py --year 2024 --week 5 --data-root "/Volumes/CK SSD/Coding Projects/cfb_model" --report-dir ./reports
- To run the remainder of the season and combine results, see docs/operations/weekly_pipeline.md → Prediction & Scoring.
