---
date: 2025-11-20
branch: main
task: [IMPL-task:MODEL-DEV] - Stabilize spread model training
---

# TL;DR (â‰¤5 lines)
- Created a new "stable" training script that addresses the root causes of numerical instability.
- The new script successfully eliminates all `RuntimeWarning`s by dropping `NaN` values and pruning features with high Variance Inflation Factor (VIF > 100).
- This is a major breakthrough, as it provides a reliable foundation for future spread model development.
- The next step is to integrate this stable training methodology into the main `walk_forward_validation.py` script for standardized evaluation.
- The experimental scripts have been cleaned up.

**tags:** ["modeling", "spread-model", "feature-engineering", "validation", "data-quality", "VIF"]

## Wins
- Successfully created a stable training pipeline (`scripts/train_stable_spread_model.py`) that produces a `Ridge` model without any numerical instability warnings.
- The root cause of the instability was confirmed to be a combination of `NaN` values and severe multicollinearity, which are now handled by the new script.
- The project now has a reliable method for training linear models on this feature set.

## Blockers
- A direct comparison of the new stable model's metrics against the production baseline was not possible due to issues with accessing the MLflow experiment data for the baseline.

## Next Steps
- **Integrate Stable Training:** The logic from `scripts/train_stable_spread_model.py` (NaN dropping, VIF pruning) should be integrated into the main `walk_forward_validation.py` script. This will allow for a consistent and reliable evaluation of all models, including the baseline ensemble.
- **Re-evaluate Models:** Once the main validation script is updated with the stable training methodology, all models (Ridge, Lasso, ElasticNet, etc.) should be re-evaluated to get a true understanding of their performance on a clean feature set.
- **Code Cleanup:** The temporary validation script (`scripts/validate_stable_spread_model.py`) has been removed. The `scripts/train_stable_spread_model.py` is left as a reference for the integration task.
