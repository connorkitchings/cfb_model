Resources updated for server: MCP_DOCKERPrompts updated for server: MCP_DOCKERTools updated for server: MCP_DOCKER# Context Analysis: Create Data Validation Service

## Repository Overview
The `cfb_model` is a Python 3.12 college football betting model project.
- **Structure**: It follows a `src`-based layout, but currently, the packages are directly under `src` (e.g., `src.utils`, `src.features`, `src.data`) rather than nested under a `src/cfb_model` package, despite the `pyproject.toml` name.
- **Configuration**: Uses Hydra-style configuration in `conf/`, though explicit Hydra integration in utility scripts is currently missing.
- **Data Flow**: Data is stored locally (`src/utils/local_storage.py`), processed via pipelines (`src/features`), and validated.

## Relevant Files & Components
- **`src/utils/validation.py`**: **CRITICAL**. This file already exists and contains ~600 lines of validation logic. It implements checks for manifest consistency, duplicates, and deep semantic validation (e.g., `validate_drives_consistency`, `validate_team_game_vs_boxscore`). It currently operates as a standalone script using `argparse`.
- **`conf/validation.yaml`**: Defines rules for `team_game` (required columns, null checks, range checks, uniqueness). **Crucially, this file is currently unused** by `src/utils/validation.py`, which relies on hardcoded checks or different logic.
- **`src/utils/logging.py`**: Contains `DataLogger` for structured JSON logging. `validation.py` currently uses `print()` statements and should likely migrate to this logger.
- **`src/utils/local_storage.py`**: Handles reading/writing data partitions (CSV/Parquet) and manifests. Used extensively by the validation logic.
- **`src/features/core.py`**: Contains core aggregation logic used for "recomputation" checks in validation.

## Existing Patterns
- **Functional validation**: `validation.py` is a collection of functions (`validate_entity`, `validate_processed_season`) rather than a cohesive class/service.
- **Dataclasses**: Uses `@dataclass` for `ValidationIssue` to structure errors/warnings.
- **Direct Execution**: Scripts in `src/utils` tend to have `if __name__ == "__main__":` blocks with `argparse`.
- **Imports**: Uses absolute imports from `src` (e.g., `from src.features.core import ...`).

## Recent Changes & Status
- **Validation Logic**: The existing `src/utils/validation.py` appears to be in an intermediate stateâ€”it has sophisticated "deep" checks (comparing derived stats vs raw boxscores) but lacks basic schema validation driven by the `conf/validation.yaml` file.
- **Pathing**: The request specifies `src/cfb_model/utils/validation.py`. The current file is `src/utils/validation.py`. This suggests a potential desire to refactor the project structure to include a `cfb_model` namespace.

## Dependencies
- **Core**: `pandas`, `json`, `pathlib`, `dataclasses`.
- **Config**: `hydra-core` (available but not fully utilized in validation script).
- **External**: `cfbd` (CollegeFootballData API) - data source implicit in the logic.

## Recommendations
1.  **Refactor to Service**: Convert the functional logic in `src/utils/validation.py` into a `DataValidationService` class to allow for better state management (e.g., holding config).
2.  **Integrate Configuration**: Connect `conf/validation.yaml` to the service. Implement a generic `validate_schema(df, schema_config)` method to enforce the rules defined in YAML (ranges, nulls) which are currently missing from the Python implementation.
3.  **Adopt Logging**: Replace `print` statements with `src/utils/logging.py`'s `DataLogger` to standardize output.
4.  **Clarify Namespace**: Determine if the goal is to *move* `src/utils/validation.py` to `src/cfb_model/utils/validation.py` (creating the namespace) or to work on the existing file. The planning agent should address this structural ambiguity.

## Potential Challenges
- **Path/Namespace Conflict**: Moving files to `src/cfb_model/` will break imports across the codebase (`from src.utils import ...` vs `from src.cfb_model.utils import ...`). A full refactor might be out of scope for a single task.
- **Logic Duplication**: `validation.py` has some hardcoded rate limits/ranges that overlap with `validation.yaml`. These need to be reconciled to avoid having two sources of truth.

**Token Usage**: ~5,200 tokens used.
