---
date: 2025-10-07
branch: main
task: IMPL-ops:2025-10-07 - Week 6 scoring and review email corrections
---

## Wins

- Ingested Week 6 games and plays; confirmed raw week-partitioned results under `raw/games/year=2025/week=6/data.csv`.
- Fixed spread scoring logic so away bets win when home favorites fail to cover (e.g., USF -28.5 vs Charlotte, margin 28 → away wins).
- Resolved data source mismatch by reading week-partitioned raw games (project root with `data_type=raw`) instead of `data/raw/games/year=YYYY/data.csv`.
- Corrected email time handling: localized report Date/Time as ET (no UTC conversion).
- Updated weekly review email columns: Date, Time, Game, Line, Model Prediction, Bet, Final Score, Final Result, Bet Result.
- Added validation to ensure scored bet counts match the original report (7 spread, 3 totals); confirmed final results: spreads 6-1, totals 2-1.
- Sent test and production review emails for Week 6 successfully.

## Blockers

- Initial duplicate rows due to merging bets against non-deduped or aggregated games data.
- Misinterpreted API responses as incomplete; root cause was reading the wrong file path (aggregated vs week-partitioned raw).
- Timezone misinterpretation (UTC conversion) led to incorrect email times; fixed by localizing to ET.

## Artifacts & Links

- New: `score_fresh.py` (fresh scoring utility from scratch)
- New: `validate_scoring.py` (bet-count verification and diagnostics)
- New: `scripts/add_game_id_to_report.py` (game_id backfill for older reports)
- Updated: `scripts/publish_review.py` (ET localization, new bet row columns)
- Updated: `templates/email_last_week_review.html` (render requested columns)
- Updated: `scripts/score_weekly_picks.py` (clarify/avoid merge duplicates when applicable)
- Reports: `reports/2025/CFB_week6_bets.csv`, `reports/2025/CFB_week6_bets_scored.csv`
- Raw results: `raw/games/year=2025/week=6/data.csv`
- Docs updated: `docs/operations/weekly_pipeline.md`, `docs/decisions/decision_log.md`

## Handoff

- Stopping Point: Week 6 scoring finalized and review emails sent.
- Next Immediate Task: Prepare next week's bets email (Week 7) and ensure models/2025 → 2024 symlink remains valid.
- Known Issues: None active after corrections; retain `score_fresh.py` as a fallback if `score_weekly_picks.py` encounters merge anomalies.
- Next Session Context: Use the updated runbook notes (ET time handling, week-partitioned raw games) and the validation script to verify counts before sending.
