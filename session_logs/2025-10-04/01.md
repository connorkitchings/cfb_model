---
date: 2025-10-04
branch: main
task: [IMPL-task:EMAIL-REVIEW] - Create "last week in review" email system and fix bet counting bug.
---

## Wins

- Successfully created a "last week in review" email system.
- Created a new script `scripts/publish_review.py` and a new template `templates/email_last_week_review.html`.
- Fixed a bug in `scripts/publish_picks.py` that was causing an undercount of bets in the model context section of the "next week's picks" email.
- Successfully generated and sent test emails for both the review and the picks for 2024 and 2025 seasons.

## Blockers

- Encountered `KeyError` and `IndentationError` due to schema changes in the `_scored.csv` files for the 2025 season and issues with the `write_file` tool.
- `mkdocs` was not found, had to reinstall dev dependencies.

## Artifacts & Links

- New files: `scripts/publish_review.py`, `templates/email_last_week_review.html`.
- Modified files: `scripts/publish_picks.py`, `gemini.md`, `WARP.md`.
- Learnings:
  - `[KB:SchemaAwareParsing]` - The schema of generated reports can change between seasons, requiring robust parsing logic.
  - `[KB:ToolingIndentationIssues]` - Be aware of potential indentation issues when using file writing tools and verify file contents.

## Handoff

- Stopping Point: All requested changes have been implemented and tested. The "last week in review" email system is functional, and the bet counting bug is fixed.
- Next Immediate Task: Integrate the `scripts/publish_review.py` script into the main `scripts/cli.py`.
- Known Issues: None.
- Next Session Context: Review the new `publish_review.py` script and discuss the integration into `cli.py`.
