---
date: 2025-10-22
branch: main
task: Threshold analysis — offense=1 / defense=3 configuration
---

## Outcomes

- Documented that offense=1, defense=3 provides the best totals RMSE (~16.75) but spreads remain flat; keeping the production default at 4/4 while noting the improvement for future tuning (`artifacts/reports/metrics/adjustment_iteration/overall_metrics_summary.csv`).
- Retrained the ensemble with that configuration, writing artifacts to `artifacts/models/off1_def3/` and logging MLflow runs with the adjusted depth metadata.
- Generated fresh 2024 weekly predictions (weeks 2–15) with wide-open thresholds/std-dev caps under the new models and stored them in `artifacts/reports/threshold_sweeps/off1_def3/`.
- Rescored the predictions and ran a full edge-threshold sweep (`spread: 4.0–8.0`, `total: 4.0–9.0`) using the betting policy helper. Results saved to:
  - `artifacts/reports/metrics/threshold_analysis/spread_threshold_sweep_off1_def3.csv`
  - `artifacts/reports/metrics/threshold_analysis/total_threshold_sweep_off1_def3.csv`
- Findings: spread hit-rate peaks ~54.7% with ROI ≈ +0.043 at an 8-point edge; totals show a monotonic ROI improvement, reaching ~0.23 per bet at a 9-point edge (61–64% hit rate) with reduced volume.
- Ran the same sweep in points-for mode (`artifacts/reports/metrics/threshold_analysis/spread_threshold_sweep_points_for_off1_def3.csv`, `.../total_threshold_sweep_points_for_off1_def3.csv`): totals improve with higher edges, spreads lag legacy, so points-for remains compare-only for now.

## Blockers

- Week 1 caches missing for offense=1/defense=3, so the sweep covers weeks 2–15 only. If we need Week 1, rebuild running/adjusted caches for that combo.

## Next Steps

- Keep operational default at 4/4; revisit 1/3 once we have multi-season ROI at the bet level.
- Roll the revised thresholds into the CLI (likely `--spread-threshold 7.5` and `--total-threshold 8.0` candidates) and backtest across 2023–2024 before committing.
- Points-for: prioritize model simplification—calibrate residual variance and trim the feature set ahead of any production rollout.
- Optional: extend the sweep to uniform caches (0/0, 1/1, 3/3) for comparison and include odds-adjusted ROI using actual line prices where available.
